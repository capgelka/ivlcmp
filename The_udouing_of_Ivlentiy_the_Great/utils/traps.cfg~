#textdomain wesnoth-ivl

#define FIRE_TRAP DAMAGE

[event]
first_time_only=no
name=moveto




[filter]
        [filter_location]
            terrain=*^Tpf*
        [/filter_location]
[/filter]
[sound]
                name=explosion.ogg
            [/sound]
 [item]   
	x=$x1
y=$y1
halo=projectiles/fire-burst-small-1.png:50,projectiles/fire-burst-small-2.png:50,projectiles/fire-burst-small-3.png:50,projectiles/fire-burst-small-4.png:50,projectiles/fire-burst-small-5.png:50,projectiles/fire-burst-small-6.png:50,projectiles/fire-burst-small-7.png:50,projectiles/fire-burst-small-8.png:50,misc/blank-hex.png:1000000
            [/item]

[harm_unit]
 [filter]
	x=$x1
y=$y1
[/filter]
amount={DAMAGE}
damage_type=fire
animate=yes
fire_event=yes
slowed=yes
[/harm_unit]
[terrain]
x=$x1
y=$y1
layer=overlay
terrain=^
[/terrain]
[/event]

#enddef

#define MAKE_FIRE_TRAP X Y
[terrain]
            x={X}
            y={Y}
 layer=overlay
            terrain=^Tpf
        [/terrain]
#enddef

#define TRAPS
[event]
  name=new_turn

first_time_only=no
{VARIABLE trap 0}

[set_menu_item]
[show_if]
[have_unit] 
             side=$side_number       
              ability=traps
                        x=$x1
                        y=$y1
[variable]
name=trap
equals=0
[/variable]
[/have_unit]

        [/show_if]
id=traps
description=_ "make trap"

 

[command]
  
{VARIABLE trapX $x1}
        {VARIABLE trapY $y1}
{MAKE_FIRE_TRAP $trapX $trapY}

{VARIABLE trap 1}

[harm_unit]
 [filter]
x=$x1
y=$y1
[/filter]
 amount=0
animate=yes
slowed=yes
[/harm_unit]
[/command]

[/set_menu_item]

[/event]
#enddef



#define TRAP_POISON DAMAGE X Y
[event]
name=moveto
[filter]
x={X}
y={Y}
[/filter]


[set_variable]
              name=unit.hitpoints
              add=-{DAMAGE}
                
           [/set_variable]
  

[modify_unit]
   [filter]
x={X}
y={Y}
[/filter]
    hitpoints=$unit.hitpoints
[status]
poisoned=yes
animate=yes
[/status]
[/modify_unit]


[/event]
{CLEAR_VARIABLE unit.hitpoints}
#enddef

#define USE DAMAGE X Y

[harm_unit]
 [filter]
x={X}
y={Y}
[/filter]
amount={DAMAGE}
animate=yes
# slowed=yes
poisoned=yes
[/harm_unit]

#enddef
